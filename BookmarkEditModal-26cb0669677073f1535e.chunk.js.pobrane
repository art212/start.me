(window.webpackJsonp=window.webpackJsonp||[]).push([[55],{2211:function(t,e,o){"use strict";o.r(e);var n,i,a,l=o(56),s=o.n(l),r=o(90),c=o.n(r),d=o(4),u=o.n(d),p=o(15),k=o(127),m=o.n(k),h=o(27),f=o(809),_=o(770),v=o(3),g={name:"BookmarkEditModal",components:{IconPickerModal:function(){return Promise.all([o.e(3),o.e(14),o.e(70)]).then(o.bind(null,2018))},SvgStrokeIcon:h.default,EmojiPickerModal:function(){return Promise.all([o.e(14),o.e(63)]).then(o.bind(null,2204))},MarkdownTextarea:function(){return o.e(9).then(o.bind(null,505))},IconChanger:function(){return o.e(315).then(o.bind(null,2235))},InputField:function(){return o.e(41).then(o.bind(null,769))},Modal:_.a},props:{id:v.a.integer.def(0)},data:function(){return{optionsTitle:{placeholder:this.$t("example_title"),linkTitle:"",isRequired:!0,hasAutofocus:!0,saveOnEnter:!0,actionSvg:this.showEmojiModal},suggestedTitle:"",hasUrlError:!1,localBookmark:{},domainsUrls:[],value:"",isFetchingDescription:!1,iconLoaded:!0}},computed:u()({},Object(p.c)("page",["getPagePublicId"]),{optionsUrl:function(){return{placeholder:this.$t("example_url"),isRequired:!0,linkTitle:"",selectArray:this.domainsUrls,saveOnEnter:!0,delay:1,hasError:this.hasUrlError}},bookmarkUrl:function(){return this.localBookmark.url},editBookmarkActionsUnified:function(){var t=this;return[{id:"duplicate",name:this.$t("duplicate_link"),clickHandler:function(){return t.openMoveSidebar([t.localBookmark],!0)},allowLiveCopy:!0},{id:"move",name:this.$t("move_link"),clickHandler:function(){return t.openMoveSidebar([t.localBookmark])}},{id:"delete",name:this.$t("delete"),isRed:!0,clickHandler:function(){return t.deleteBookmarkHandler()},isHeadOfSection:!0}]}}),watch:{bookmarkUrl:m()((function(t){var e=this,o=(t||"").trim(),n=this.$urlHelper.getDomain(o);if(n.length>1)return this.fetchDomainTitle(o),this.getDomainsUrls(n).then((function(t){e.domainsUrls=t.domains.filter((function(t){return t.domain!==o}))}));this.domainsUrls=[]}),500)},beforeCreate:function(){void 0!==this.$store.state.sidebars&&this.$store.state.sidebars.registered||(this.$store.registerModule("sidebars",f.a),this.$store.dispatch("sidebars/setRegistered"))},methods:u()({},Object(p.b)(["deleteBookmark","saveBookmark","getDomainsUrls"]),Object(p.b)("sidebars",["fetchLinkOriginalDescription"]),{editBookmarkCollector:function(){return this.localBookmark.url=this.$urlHelper.getValidUrl(this.localBookmark.url),this.localBookmark},showEmojiModal:(a=c()(s.a.mark((function t(){var e,o;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.$refs.emojiModal.pick();case 3:e=t.sent,o=document.getElementsByClassName("input-field__input"),this.localBookmark.title=this.localBookmark.title.slice(0,o[0].selectionStart)+e+this.localBookmark.title.slice(o[0].selectionStart),t.next=10;break;case 8:t.prev=8,t.t0=t.catch(0);case 10:case"end":return t.stop()}}),t,this,[[0,8]])}))),function(){return a.apply(this,arguments)}),applyOnEnter:function(){this.$refs.modal.apply()},editBookmarkWithModal:(i=c()(s.a.mark((function t(e){var o;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.localBookmark=Object.assign({},e),this.localBookmark.icon=this.$iconHelper.getSplittedIcon(e).icon,""!==this.$iconHelper.getSplittedIcon(e).iconColor&&(this.localBookmark.iconColor=this.$iconHelper.getSplittedIcon(e).iconColor),t.prev=3,t.next=6,this.$refs.modal.show();case 6:o=t.sent,(/(^fa-)|(^fontawesome:)|f.start.me\/fa\//.test(o.icon)||/(^texticon:)/.test(o.icon))&&(o.icon=o.icon+"?color="+o.iconColor),this.saveBookmark({publicId:o.tab&&o.tab.public_id?o.tab.public_id:this.getPagePublicId(this.$route),widgetId:this.id,bookmarkId:o.item_id||o.id,bookmark:o,bookmarkData:o}),t.next=13;break;case 11:t.prev=11,t.t0=t.catch(3);case 13:case"end":return t.stop()}}),t,this,[[3,11]])}))),function(t){return i.apply(this,arguments)}),titleSuggestionClick:function(){this.localBookmark.title=this.suggestedTitle},fetchDomainTitle:function(t){var e=this,o=this.$urlHelper.getBeautifiedUrl(t);o&&this.$urlHelper.getDomainTitle(o).then((function(o){var n;n=o.title?o.title:e.$urlHelper.getHostName(e.bookmarkUrl.trim())?e.$utils.capitalize(e.$urlHelper.getHostName(e.bookmarkUrl.trim())):e.$utils.capitalize(t.replace(/^https?:\/\//i,"")),(e.$urlHelper.isIPAddress(t)||e.$urlHelper.isCustomUrl(t))&&(n=n.replace(/\/$/,"")),e.suggestedTitle=n})).catch((function(){var o;o=e.$urlHelper.getHostName(e.bookmarkUrl.trim())?e.$utils.capitalize(e.$urlHelper.getHostName(e.bookmarkUrl.trim())):e.$utils.capitalize(t.replace(/^https?:\/\//i,"")),e.suggestedTitle=o}))},getOriginalDescription:function(){var t=this;this.isFetchingDescription=!0,this.fetchLinkOriginalDescription({linkId:this.localBookmark.link_id}).then((function(e){var o=e.data;t.localBookmark.description=o.description,t.isFetchingDescription=!1})).catch((function(){t.isFetchingDescription=!1}))},openMoveSidebar:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=this.$utils.defer();return this.$eventBus.$emit("toggle-sidebar",{name:"moveBookmark"},{sourceWidgetId:this.id,currentPagePublicId:this.getPagePublicId(this.$route),bookmarks:t,isDuplicating:e,deferred:o}),this.$refs.modal.discard(),o.promise},deleteBookmarkHandler:function(){var t={publicId:this.getPagePublicId(this.$route),widgetId:this.id,bookmarkId:this.localBookmark.item_id};this.$refs.modal.discard(),this.$eventBus.$emit("delete-bookmark",[this.localBookmark.item_id]),this.deleteBookmark(t).catch(this.$logger.log)},optionsAction:function(t){var e=this,o=this.editBookmarkActionsUnified;if(o&&0!==o.length){var n=t.pageX,i=t.pageY+14;this.isContextMenuOpened=!0,this.$eventBus.$emit("toggle-unifiedmenu",{menuElements:o,positionX:n,positionY:i,positionToLeftOfX:!0,closeHandler:function(){e.isContextMenuOpened=!1}})}},changeIcon:(n=c()(s.a.mark((function t(){var e;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.$refs.iconPickerModal.pick();case 3:e=t.sent,this.iconLoaded=!1,this.localBookmark.icon=e[0],this.localBookmark.iconColor=e[1],this.iconLoaded=!0,t.next=12;break;case 10:t.prev=10,t.t0=t.catch(0);case 12:case"end":return t.stop()}}),t,this,[[0,10]])}))),function(){return n.apply(this,arguments)}),resetIcon:function(){""===this.localBookmark.favicon?this.localBookmark.icon=this.$urlHelper.getBookmarkIcon(this.bookmarkUrl):this.localBookmark.icon=this.localBookmark.favicon}})},b=g,B=o(8),C=Object(B.a)(b,(function(){var t=this,e=t._self._c;return e("div",[e("Modal",{ref:"modal",attrs:{"has-apply-action":"",collector:t.editBookmarkCollector,title:t.$t("edit_link"),"has-delete-action":"","delete-action":t.deleteBookmarkHandler,"delete-button-caption":t.$t("delete_link")},scopedSlots:t._u([{key:"headerComponent",fn:function(){return[e("span",{staticClass:"new-modal__option",on:{click:t.optionsAction}},[e("SvgStrokeIcon",{staticClass:"new-modal__control-icon",attrs:{icon:"more-vertical",options:{size:14}}})],1)]},proxy:!0},{key:"mainComponent",fn:function(){return[e("span",{staticClass:"new-modal__label"},[t._v("\n        "+t._s(t.$t("icon"))+"\n      ")]),t._v(" "),t.iconLoaded?e("IconChanger",{staticClass:"new-modal__form_component",attrs:{icon:t.localBookmark.icon,"change-handler":t.changeIcon,"reset-handler":t.resetIcon,"icon-color":t.localBookmark.iconColor,"icon-alt":t.localBookmark.title}}):t._e(),t._v(" "),e("div",{staticClass:"new-modal__label_container"},[e("span",{staticClass:"new-modal__label"},[t._v("\n          "+t._s(t.$t("title"))+"\n        ")]),t._v(" "),t.suggestedTitle!==t.localBookmark.title?e("a",{staticClass:"new-modal__sublink",on:{click:function(e){return t.titleSuggestionClick()}}},[t._v("\n          "+t._s(t.$t("bookmarks_adder.suggested_title",{title:t.suggestedTitle}))+"\n        ")]):t._e()]),t._v(" "),e("InputField",{staticClass:"new-modal__form_component",attrs:{options:t.optionsTitle},on:{"save-on-enter":t.applyOnEnter},model:{value:t.localBookmark.title,callback:function(e){t.$set(t.localBookmark,"title",e)},expression:"localBookmark.title"}}),t._v(" "),e("span",{staticClass:"new-modal__label"},[t._v("\n        "+t._s(t.$t("url"))+"\n      ")]),t._v(" "),e("InputField",{staticClass:"new-modal__form_component",attrs:{options:t.optionsUrl},on:{"save-on-enter":t.applyOnEnter},model:{value:t.localBookmark.url,callback:function(e){t.$set(t.localBookmark,"url",e)},expression:"localBookmark.url"}}),t._v(" "),e("div",{staticClass:"new-modal__label_container"},[e("span",{staticClass:"new-modal__label"},[t._v("\n          "+t._s(t.$t("description"))+"\n        ")]),t._v(" "),e("a",{staticClass:"new-modal__sublink",on:{click:function(e){return t.getOriginalDescription()}}},[t._v("\n          "+t._s(t.isFetchingDescription?t.$t("loading"):t.$t("get_site_default_description"))+"\n        ")])]),t._v(" "),e("MarkdownTextarea",{staticClass:"new-modal__form_component",model:{value:t.localBookmark.description,callback:function(e){t.$set(t.localBookmark,"description",e)},expression:"localBookmark.description"}}),t._v(" "),e("EmojiPickerModal",{ref:"emojiModal"}),t._v(" "),e("IconPickerModal",{ref:"iconPickerModal",attrs:{"selected-icon":t.localBookmark.icon,"selected-color":t.localBookmark.iconColor,"selected-url":t.localBookmark.url,"selected-favicon":t.localBookmark.favicon}})]},proxy:!0}])})],1)}),[],!1,null,null,null);e.default=C.exports},713:function(t,e,o){},716:function(t,e,o){"use strict";var n=o(3),i=o(489),a=o(488),l=o(27),s={name:"StandardButton",components:{ThreeDotsSpinner:i.default,PremiumMark:a.default,SvgStrokeIcon:l.default},props:{caption:n.a.string.isRequired.def(""),popup:n.a.string,href:n.a.string.def(""),isDisabled:n.a.bool.def(!1),isHidden:n.a.bool.def(!1),isAccent:n.a.bool.def(!1),isAccentLight:n.a.bool.def(!1),isWarning:n.a.bool.def(!1),icon:n.a.string.def(""),hasInlineIcon:n.a.bool.def(!1),target:n.a.oneOf(["_blank","_self","_top"]).def("_self")}},r=(o(717),o(8)),c=Object(r.a)(s,(function(){var t=this,e=t._self._c;return e("a",{staticClass:"standard-button",class:{"standard-button_accent":t.isAccent,"standard-button_light-accent":t.isAccentLight,"standard-button_warning":t.isWarning,"standard-button_disabled":t.isDisabled,"standard-button_hidden":t.isHidden},attrs:{href:t.href.length>0?t.href:"javascript:;",target:t.target,title:t.popup}},[e("span",{staticClass:"standard-button__caption"},[[t._v(" "+t._s(t.caption)+" ")],t._v(" "),t.icon&&t.hasInlineIcon?e("SvgStrokeIcon",{staticClass:"standard-button__icon standard-button__icon_inline",attrs:{icon:t.icon,options:{size:14}}}):t._e()],2),t._v(" "),t.icon&&!t.hasInlineIcon?e("SvgStrokeIcon",{staticClass:"standard-button__icon",attrs:{icon:t.icon,options:{size:14}}}):t._e()],1)}),[],!1,null,null,null);e.a=c.exports},717:function(t,e,o){"use strict";o(713)},756:function(t,e,o){},770:function(t,e,o){"use strict";var n,i=o(56),a=o.n(i),l=o(90),s=o.n(l),r=o(810),c=o(716),d=o(27),u=o(3),p=o(498),k={name:"Modal",components:{Overlay:r.default,StandardButton:c.a,SvgStrokeIcon:d.default,Portal:p.Portal},props:{title:u.a.string.def(""),applyButtonCaption:u.a.string.def(""),discardButtonCaption:u.a.string.def(""),deleteButtonCaption:u.a.string.def(""),hasApplyAction:u.a.bool.def(!1),hasDiscardAction:u.a.bool.def(!1),hasDeleteAction:u.a.bool.def(!1),order:u.a.integer.def(0),valid:u.a.bool.def(!0),collector:u.a.func.def((function(t){return t})),applyOnClose:u.a.bool.def(!1),customClass:u.a.string,deleteAction:u.a.func.def((function(){}))},data:function(){return{isVisible:!1,resolve:function(){},reject:function(){},localApplyButtonCaption:"",localDiscardButtonCaption:"",localDeleteButtonCaption:""}},methods:{apply:function(t){this.isVisible=!1,this.resolve(this.collector(t))},discard:function(){this.isVisible=!1,this.reject(new Error("Modal action discard"))},close:function(){this.applyOnClose?this.apply():this.discard()},deleteClick:function(){this.deleteAction(),this.close()},show:(n=s()(a.a.mark((function t(){var e=this;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return""===this.applyButtonCaption?this.localApplyButtonCaption=this.$t("done"):this.localApplyButtonCaption=this.applyButtonCaption,""===this.discardButtonCaption?this.localDiscardButtonCaption=this.$t("cancel"):this.localDiscardButtonCaption=this.discardButtonCaption,""===this.deleteButtonCaption?this.localDeleteButtonCaption=this.$t("delete"):this.localDeleteButtonCaption=this.$t(this.deleteButtonCaption),t.abrupt("return",new Promise((function(t,o){e.resolve=t,e.reject=o,e.isVisible=!0})));case 4:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})}},m=k,h=(o(802),o(8)),f=Object(h.a)(m,(function(){var t=this,e=t._self._c;return t.isVisible?e("portal",{attrs:{to:"modalDestination"}},[e("div",{staticClass:"new-modal",on:{keyup:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"])?null:(e.stopPropagation(),t.close.apply(null,arguments))},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.apply.apply(null,arguments)}]}},[e("Overlay",{staticClass:"new-modal__overlay",attrs:{"overlay-on-context-handler":t.close,"on-click-handler":t.close,"semi-transparent":!0}}),t._v(" "),e("transition",[e("div",{staticClass:"new-modal__container",class:t.customClass},[e("div",{staticClass:"new-modal__header"},[e("span",{staticClass:"new-modal__title"},[t._v("\n            "+t._s(t.title)+"\n          ")]),t._v(" "),t._t("headerComponent"),t._v(" "),e("span",{staticClass:"new-modal__close",on:{click:function(e){return e.stopPropagation(),t.close.apply(null,arguments)}}},[e("SvgStrokeIcon",{staticClass:"new-modal__control-icon",attrs:{icon:"x",options:{size:14}}})],1)],2),t._v(" "),e("div",{staticClass:"new-modal__component_container"},[t._t("mainComponent")],2),t._v(" "),e("div",{staticClass:"new-modal__footer"},[e("div",{staticClass:"new-modal__footer_buttons"},[t.hasApplyAction?e("StandardButton",{staticClass:"new-modal__footer__button",attrs:{disabled:!t.valid,caption:t.localApplyButtonCaption},nativeOn:{click:function(e){return t.apply.apply(null,arguments)}}}):t._e(),t._v(" "),t.hasDiscardAction?e("StandardButton",{staticClass:"new-modal__footer__button new-modal__footer__button_discard",attrs:{caption:t.localDiscardButtonCaption},nativeOn:{click:function(e){return t.discard.apply(null,arguments)}}}):t._e(),t._v(" "),t.hasDeleteAction?e("StandardButton",{staticClass:"new-modal__footer__button new-modal__footer__button_delete",attrs:{caption:t.localDeleteButtonCaption},nativeOn:{click:function(e){return t.deleteClick.apply(null,arguments)}}}):t._e()],1),t._v(" "),e("div",{staticClass:"new-modal__footer_addon"},[t._t("footerComponent")],2)])])])],1)]):t._e()}),[],!1,null,null,null);e.a=f.exports},802:function(t,e,o){"use strict";o(756)}}]);