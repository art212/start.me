(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{1357:function(e,t,s){"use strict";s.r(t);var r=s(13),i=s.n(r),n=s(4),o=s.n(n),a=s(15),c=s(3),h=s(127),u=s.n(h),l=s(27),d=s(7),p=s(5),g="settings",f={name:"SearchBar",components:{SearchResults:function(){return s.e(47).then(s.bind(null,2205))},DropList:function(){return s.e(13).then(s.bind(null,1986))},SvgStrokeIcon:l.default},props:{isAlternate:c.a.bool.def(!1),noAutofocus:c.a.bool.def(!1),isMobile:c.a.bool.def(!1),isEditable:c.a.bool.def(!1),hasBackground:c.a.bool.def(!1),themeColor:c.a.any.def(null),options:c.a.object.def({})},data:function(){return{isExpanded:!1,searchInput:this.$routeHelper.queryDecodedValue("q"),searchResults:[],searchSuggestions:[],startmeResults:{},rememberedInput:"",selectedIndex:-1,isChangeIgnored:!1,isInputFocused:!1,isResultsDropdownActive:!1,denyDropdown:!1,activeTab:0,isLoadingBookmarks:!1,isStartmeSearchLoading:!1,selectedProvider:null,totalBookmarks:0}},computed:o()({},Object(a.c)(["getSearchProviders","getCurrentProvider","getProviderById","getCustomDomainData","getUserPreferences","isLoggedIn","getUserData","isProUser","isDarkTheme","isWidgetEditState"]),Object(a.c)("page",["getPageData","getPagePublicId","canEdit"]),{maxResultsNumber:function(){return 8},webTabId:function(){return"web"},placeholder:function(){return this.isDiscover?this.$t("search_in_startme"):this.isAlternate?this.$t("search"):this.isGoogleCustomProvider?this.$t("search_the_web"):this.selectedProvider?this.selectedProvider.name:this.currentProvider.name},hasDarkUnderlay:function(){if(this.isGoogleSearch)return!1;if(this.isDarkTheme)return!0;if(this.hasBackground)return!1;var e="number"===typeof this.themeColor?this.themeColor:p.a.pageThemeColors.integer.light,t=this.$colors.blendWith(0,e,.9);return this.$colors.isDark(this.$colors.getRgbFromInteger(t))},pageSize:function(){return 10},newWindow:function(){return this.getUserPreferences&&this.getUserPreferences.open_links_in_new_window&&!(this.isMobile&&this.$utils.hasTouchScreen())},hasBookmarksPagination:function(){return this.bookmarksPagination&&this.bookmarksPagination.total&&this.bookmarksPagination.total>1},defaultTab:function(){return 0},isGoogleSearch:function(){return["SearchEmbedGoogle","SearchEmbedExternal","SearchEmbedGoogleStartme"].includes(this.$route.name)},isDiscover:function(){return["DiscoverPage","DiscoverSitePage","DiscoverSiteSeparatePage"].includes(this.$route.name)},isGoogleCustomProvider:function(){var e=/\/search\/google\?q=/;return!this.currentProvider||!this.currentProvider.url||e.test(this.currentProvider.url)||this.selectedProvider&&e.test(this.selectedProvider.url)},searchProviders:function(){var e=this.getSearchProviders.filter((function(e){return e.show||e.default}));return e=e.map((function(e,t){return{id:String(e.id),isDefault:e.default,name:e.name,value:e.id,url:e.url,favicon:e.icon,useSubstitute:!0}})),this.isLoggedIn&&!this.isTorchPage&&e.push({id:g,name:this.$t("search_settings"),value:g,isSeparated:!0}),e},isTorchPage:function(){return this.getCustomDomainData&&this.getCustomDomainData.domain.match(/torch/gi)},currentProvider:function(){return void 0!==this.options.currentProvider?this.getProviderById(this.options.currentProvider):this.getCurrentProvider?this.getCurrentProvider:this.searchProviders.length>1?this.searchProviders[0]:this.getSearchProviders[0]||p.a.defaultSearchProvider},results:function(){var e=i()(this.searchSuggestions),t=i()(this.searchResults),s=0;return e.length>8&&(e=e.slice(0,8)),(t=t.filter((function(e){return!e.isDeleted}))).length>6&&(s=t.length,t=t.slice(0,6)),{web:e,bookmarks:t,moreNumber:s}},searchLength:function(){return this.searchSuggestions.length>10?10:this.searchSuggestions.length},initialSearchQueryProvided:function(){return!!this.$route.query.q},hasSuggestions:function(){return this.searchSuggestions.length>0},favicon:function(){if(this.isGoogleCustomProvider)return"";if(this.currentProvider.icon)return this.currentProvider.icon;if(!this.currentProvider.url)return"";try{return this.$urlHelper.faviconLink(this.currentProvider.url)}catch(e){return this.$urlHelper.faviconLink("https://start.me")}},searchPagesPhrase:function(){return this.$t("search_for_x_in_startme",{phrase:this.searchInput.trim()})},isWidgetEditMode:function(){return this.isWidgetEditState}}),watch:{"$route.query.q":{handler:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.isGoogleSearch&&this.searchInput!==e&&(this.isChangeIgnored=!0,this.searchInput=e,this.rememberedInput=e,this.closeSearchDropdown())}},searchInput:u()((function(e){if(this.isChangeIgnored)this.isChangeIgnored=!1;else{if(e&&e.trim().length?this.showDropdown():this.hideDropdown(),this.rememberedInput=e,!e)return this.searchResults=[],void(this.searchSuggestions=[]);this.searchBookmarks(e),this.getSearchSuggestions(encodeURIComponent(e))}}),500)},created:function(){this.isGoogleSearch&&(this.rememberedInput=this.$routeHelper.queryDecodedValue("q")),this.setWidgetEditMode(!1),this.$eventBus.$on("keypress-escape",this.closeSearchDropdown)},mounted:function(){var e=this;this.isMobile?this.$eventBus.$on("clear-search",this.processSearchClearing):this.noAutofocus||window.setTimeout((function(){var t=document.querySelector("html").classList;t&&t.contains("has-firefox-extension")||e.activateFocus()}),0)},beforeDestroy:function(){this.$eventBus.$off("keypress-escape",this.closeSearchDropdown),this.$eventBus.$off("clear-search",this.processSearchClearing)},methods:o()({},Object(a.b)(["setWidgetEditMode"]),{openBookmark:function(e){var t=e.url;this.getUserData&&"number"===typeof this.getUserData.id&&!this.getUserData.show_ads||(t=this.$urlHelper.monetizeUrl(e.url,e.monetizer)),this.openUrl(t,null,this.newWindow),this.closeSearchDropdown()},presetActiveTab:function(){return 0},showDropdown:function(){this.isResultsDropdownActive=!0},hideDropdown:function(){this.isResultsDropdownActive=!1},activateFocus:function(){try{this.$refs.input.focus()}catch(e){}},deactivateFocus:function(){try{this.$refs.input.blur()}catch(e){}},search:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(""!==this.searchInput.trim()){this.$eventBus.$emit("gtm-event","Search",{provider:this.currentProvider.name,query:this.searchInput});var s;if(this.$urlHelper.isValid(this.searchInput)?s=this.searchInput:this.$urlHelper.isValidButWithoutProtocol(this.searchInput)&&/^www\./i.test(this.searchInput)&&(s="https://".concat(this.searchInput)),s)return this.openUrl(s),void(this.searchInput="");var r=this.searchInput.trim();if(this.isGoogleSearch){var i=t?"SearchEmbedGoogle":this.$route.name;this.$router.push({name:i,query:{q:r}})}else{if(this.hideDropdown(),this.isGoogleCustomProvider){var n=this.$router.resolve({name:"SearchEmbedGoogle",query:{q:r}});if(this.newWindow)return void this.openUrl(n.href,null,!0);var o=!1;try{o=window.self!==window.top}catch(c){o=!0}return this.denyDropdown=!0,void(o?window.open(n.href,"_top"):this.$router.push({name:"SearchEmbedGoogle",query:{q:r}}))}this.denyDropdown=!this.newWindow;var a=this.currentProvider.url.replace("%s",encodeURIComponent(r));this.openUrl(a,null,this.newWindow)}}},forceInputClearance:function(){this.newWindow&&!this.isGoogleSearch&&(this.searchInput="")},searchBookmarks:function(e){var t=this;this.searchResults=[],this.totalBookmarks=0,this.bookmarksPagination=null,this.isLoadingBookmarks=!0,d.b.findBookmarks(e).then((function(s){var r=s.data,n=[],o=t.$utils.toQueryMatcher(e);r.links_bookmarks&&r.links_bookmarks.length&&(n=r.links_bookmarks.map((function(e){return t.formatBookmarks(e,o)}))),r.links_total&&(t.totalBookmarks=r.links_total),n.sort((function(e,t){var s=t.score-e.score;return s||((s=e.url.length-t.url.length)||e.title.localeCompare(t.title))})),t.isLoadingBookmarks=!1,(t.isInputFocused||t.isMobile)&&(t.searchResults=i()(n),t.bookmarksPagination={current:1,total:Math.ceil(i()(n).length/10)})})).catch((function(){t.isLoadingBookmarks=!1}))},formatBookmarks:function(e,t){return e.score=Math.max(t(e.title),t(e.url)),e.html=e.markWidget?e.title:this.$utils.formatSuggestion(e.title,this.searchInput),e.favicon=this.$urlHelper.faviconLink(e.url),e},getSearchSuggestions:function(e){var t=this,s="psy",r="";"Google Images"===this.currentProvider.name?(s="img",r="i"):"YouTube"===this.currentProvider.name&&(s="youtube",r="yt");var i={q:e,nolabels:"t",hl:"en",client:s,ds:r};this.getSuggestions(i).then((function(e){if(t.isInputFocused||t.isMobile){var s=t.$featurizr&&"safari"===t.$featurizr.browser,r=s?e.data:e;t.searchSuggestions=r[1].map((function(e){var r=s?e[0]:e;return{html:t.$utils.formatSuggestion(r,t.searchInput),title:r}}))}}))},getSuggestions:function(e){return this.$featurizr&&"safari"===this.$featurizr.browser?d.b.getExternalUrlData("https://suggestqueries.google.com/complete/search?client=safari&q=".concat(e.q)):d.b.getProviderSuggestions(e)},searchOptionClickHandler:function(e,t){var s=e.id;t&&t.stopPropagation(),this.toggleDropList(),s!==g?(this.$eventBus.$emit("set-search-provider",Number(s)),this.activateFocus(),this.setSelectedProvider()):this.$eventBus.$emit("toggle-sidebar",{name:"searchProviders"})},setSelectedProvider:function(){this.selectedProvider=this.currentProvider?o()({},this.currentProvider):null},toggleDropList:function(){this.isExpanded=!this.isExpanded},closeDropList:function(){this.isExpanded=!1},closeSearchDropdown:function(){this.searchResults=[],this.searchSuggestions=[],this.selectedProvider||(this.activeTab=this.defaultTab),this.isLoadingBookmarks=!1,this.bookmarksPagination=null,this.unsetFocus(),this.closeDropList(),this.hideDropdown()},processSearchClearing:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.$nextTick((function(){t.setFocus?e.activateFocus():e.deactivateFocus(),e.clearSearchInput()}))},clearSearchInput:function(){var e=this;u()((function(){e.searchInput="",e.searchResults=[],e.searchSuggestions=[],e.selectedIndex=-1,e.isLoadingBookmarks=!1,e.bookmarksPagination=null}),100)()},openSearchPage:function(e){if(this.$eventBus.$emit("gtm-event","Search",{provider:this.currentProvider.name,query:e}),this.isGoogleSearch)this.$router.push({name:this.$route.name,query:{q:e}});else if(this.isGoogleCustomProvider){if(this.hideDropdown(),this.newWindow){var t=this.$router.resolve({name:"SearchEmbedGoogle",query:{q:e}});return void this.openUrl(t.href,null,!0)}this.$router.push({name:"SearchEmbedGoogle",query:{q:e}})}else this.hideDropdown(),this.openUrl(this.currentProvider.url.replace("%s",encodeURIComponent(e)),null,this.newWindow)},openSuggestion:function(e){this.searchInput=e,this.rememberedInput=e,this.selectedIndex=-1,this.onEnterHandler(null,{forceGoogleCustomSearch:!0})},setSelected:function(e){this.selectedIndex=e},changeSelected:function(e){var t=this.results.web.slice(0,this.maxResultsNumber),s=this.selectedIndex+e;s<-1?(this.selectedIndex=t.length-1,this.isChangeIgnored=!0,this.updateSearchInput(t[t.length-1])):s>t.length?(this.selectedIndex=0,this.isChangeIgnored=!0,this.updateSearchInput(t[0])):(this.selectedIndex=s,this.isChangeIgnored=!0,s>-1&&s<t.length?this.updateSearchInput(t[s]):this.searchInput=this.rememberedInput)},updateSearchInput:function(e){e.html?this.searchInput=e.title:this.searchInput=""},checkSelected:function(e){return e===this.selectedIndex},onEnterHandler:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};-1===this.selectedIndex?this.search(null,t.forceGoogleCustomSearch):this.searchInput&&this.openSearchPage(this.searchInput),this.reset()},getFavicon:function(){if(this.currentProvider.icon)return this.currentProvider.icon;if(!this.currentProvider.url)return"";try{return this.$urlHelper.faviconLink(this.currentProvider.url)}catch(e){return this.$urlHelper.faviconLink("https://start.me")}},setFocus:function(){this.closeDropList(),!this.isInputFocused&&(this.searchInput===this.$route.query.q||!this.isAlternate&&this.searchInput.length>1)&&(this.searchBookmarks(this.searchInput),this.getSearchSuggestions(this.searchInput)),this.isInputFocused=!0,this.searchInput&&this.searchInput.trim().length&&this.showDropdown()},unsetFocus:function(){this.isInputFocused=!1,this.deactivateFocus()},openUrl:function(e){this.$urlHelper.openUrl(e,null,!1,this.isGoogleSearch)},resetInput:function(){this.searchInput="",this.closeSearchDropdown(),this.activateFocus()},activateTab:function(e){this.activeTab=e,this.selectedIndex=-1,this.searchInput=this.rememberedInput},reset:function(){this.unsetFocus(),this.closeSearchDropdown(),this.forceInputClearance()},isFontAwesome:function(e){return 0===e.indexOf("fa-")},onInput:function(e){this.closeDropList(),this.searchInput=e.target.value||""},openProvidersDropdown:function(e){this.toggleDropList()},checkStoppingPropagation:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.isInputFocused&&e.stopPropagation()}})},v=f,m=(s(906),s(8)),k=Object(m.a)(v,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"search-container"},[t("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:e.closeSearchDropdown,expression:"closeSearchDropdown"}],staticClass:"search",class:{search_alternate:e.isAlternate,search_enlarged:e.isMobile,search_centered:e.isDiscover,search_wide:e.hasDarkUnderlay,search_rounded:!(e.isResultsDropdownActive&&!e.denyDropdown)},on:{contextmenu:function(e){e.stopPropagation()}}},[e.currentProvider?t("div",{staticClass:"search__wrapper",class:{search__wrapper_active:e.isResultsDropdownActive}},[t("div",{staticClass:"search__form",class:{search__form_shadow:e.isWidgetEditMode}},[!e.isAlternate&&e.favicon?t("span",{staticClass:"search__icon-box",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.openProvidersDropdown.apply(null,arguments)}}},[t("img",{staticClass:"search__logo-icon",attrs:{alt:"",src:e.favicon}})]):e.isAlternate||e.favicon?e._e():t("span",{staticClass:"search__icon-box",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.openProvidersDropdown.apply(null,arguments)}}},[t("img",{staticClass:"search__logo-icon",attrs:{alt:"",src:"https://f.start.me/fa/globe?color=gray"}})]),e._v(" "),!e.isAlternate&&(e.isLoggedIn||e.searchProviders.length>1)?t("span",{staticClass:"search__menu",class:{search__dark_menu:e.isWidgetEditMode}}):e._e(),e._v(" "),t("input",{ref:"input",staticClass:"search__input",class:{search__input_favicon:e.isAlternate},attrs:{autocomplete:"off","aria-label":e.$t("search"),placeholder:e.placeholder},domProps:{value:e.searchInput},on:{input:e.onInput,keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onEnterHandler.apply(null,arguments)},keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"down",40,t.key,["Down","ArrowDown"])?null:e.changeSelected(1)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"up",38,t.key,["Up","ArrowUp"])?null:e.changeSelected(-1)}],focus:e.setFocus,click:e.activateFocus,paste:e.checkStoppingPropagation}}),e._v(" "),e.searchInput.length?[e.$utils.hasTouchScreen()?t("a",{staticClass:"search__button search__button_clear",on:{click:function(t){return t.stopPropagation(),e.resetInput.apply(null,arguments)}}},[t("SvgStrokeIcon",{staticClass:"search__control-icon",attrs:{icon:"x",options:{size:16}}})],1):t("a",{staticClass:"search__button search__button_clear search__button_static",on:{click:function(t){return t.stopPropagation(),e.resetInput.apply(null,arguments)}}},[t("SvgStrokeIcon",{staticClass:"search__control-icon",attrs:{icon:"x",options:{size:16}}})],1)]:e._e(),e._v(" "),t("div",{staticClass:"search__dropdown"},[t("i",{staticClass:"search__dropdown-stub"}),e._v(" "),e.isExpanded?t("DropList",{staticClass:"search__drop-settings",attrs:{"is-bound-by-page":"","is-freezed":"",items:e.searchProviders,"click-handler":e.searchOptionClickHandler}}):e._e()],1),e._v(" "),t("a",{key:"search_button",staticClass:"search__button search__button_spaced_right",on:{click:e.onEnterHandler}},[t("SvgStrokeIcon",{staticClass:"search__control-icon",attrs:{icon:"search",options:{size:16}}})],1)],2),e._v(" "),e.isResultsDropdownActive&&!e.denyDropdown?t("SearchResults"):e._e()],1):e._e(),e._v(" "),e.isGoogleSearch?t("img",{staticClass:"search__google-logo",attrs:{src:s(905)}}):e._e()])])}),[],!1,null,null,null);t.default=k.exports},824:function(e,t,s){},905:function(e,t,s){e.exports=s.p+"media/images/google_logo-5229f9f2.png"},906:function(e,t,s){"use strict";s(824)}}]);