(window.webpackJsonp=window.webpackJsonp||[]).push([[89],{1120:function(t,e,i){},1591:function(t,e,i){"use strict";i(1120)},2060:function(t,e,i){"use strict";i.r(e);var s=i(13),n=i.n(s),a=i(92),o=i.n(a),c=i(4),r=i.n(c),l=i(15),u=i(182),d=i.n(u),h=i(493),g=i(492),_=i(868),p=i(27),f={"01d":"clear","01n":"nt_clear","02d":"mostlycloudy","02n":"nt_mostlycloudy","03d":"cloudy","03n":"cloudy","04n":"cloudy","04d":"cloudy","09d":"chancerain","09n":"chancerain","10d":"chancerain","10n":"chancerain","11d":"chancetstorms","11n":"chancetstorms","13d":"chanceflurries","13n":"chanceflurries","50d":"fog","50n":"fog"},w={name:"WeatherWidget",components:{BaseWidget:h.a,AutocompleteList:_.a,draggable:d.a,SvgStrokeIcon:p.default},mixins:[g.a],data:function(){return{help_article:"200153682-Weather",icon:"",defaultIcon:"cloud-rain",isFormBlurred:!1,isInputSelected:!1,newCityInput:"",preview:{title_phrase:"weather",cities:[{n:"New York",lat:40.75,lon:-74}]}}},computed:r()({},Object(l.c)(["getForecastData"]),{settingsToCopy:function(){return this.widgetData.settings?{m:this.widgetData.settings.m}:null},layeredContextMenuConfig:function(){var t=this,e={title:this.$t("general")},i=this.getWidgetActionsField();i.items.splice(1,0,{id:"refresh",label:this.$t("refresh"),clickHandler:function(){t.fetchForecastData(!0),t.closeContextSidebar()}});var s=this.getLayeredContextMenuConfig(i);if(this.checkContext(this.contextMenuIds.DISPLAY_ID)){var n=[[{label:this.$t("temperature"),type:"oneRowRadio",vmodel:this.settings,vmodelField:"m",options:[{id:"fahrenheit",value:0,label:this.$t("metric_fahrenheit")},{id:"celcius",value:1,label:this.$t("metric_celsius")}],inputChangeHandler:function(){t.saveSettings()}}]];if(this.settingsToCopy){var a={label:"",type:"actionsList",items:[{label:this.$t("apply_to_all_widgets"),isBlue:!0,isSeparated:!0,isRegular:!0,clickHandler:function(){t.$$distributeWidgetSettings(),t.closeContextSidebar()}}]};n[0].push(a)}s.push({headerTitle:this.$t("display_settings"),hasArrow:!0,listenHeader:!0,hasClose:!0,headerClickHandler:function(){t.removeContext(t.contextMenuIds.DISPLAY_ID)},tabs:[e],fields:n,activeTab:0})}return s},forecastData:function(){return this.getForecastData(this.cities)},cities:function(){return this.widgetData.isPreviewMode?this.preview.cities:this.settings&&this.settings.c?this.settings.c:[]},isFahrenheit:function(){return 0===this.temperatureSystem},temperatureSystem:function(){return this.settings.m}}),watch:{isEditingState:function(t){t?this.$nextTick(this.activateInput):this.clearCityEntry()},cities:function(t,e){t.length!==e.length&&this.fetchForecastData(!0)},temperatureSystem:function(){this.saveSettings()}},created:function(){this.fetchForecastData()},methods:r()({},Object(l.b)(["fetchCitySuggestions","fetchWeatherForecast","removeForecastItem"]),{activateInput:function(){var t=this;this.$nextTick((function(){t.isFormBlurred=!1,t.isInputSelected=!0}))},clearCityEntry:function(){this.newCityInput=""},addCity:function(t){if(void 0!==t){var e=t.value.split(","),i=o()(e,2),s=i[0],a=i[1];if(s&&a){var c={n:t.name,lat:Number(s),lon:Number(a)};this.cities.some((function(t){return Number(t.lat).toFixed(6)===c.lat.toFixed(6)&&Number(t.lon).toFixed(6)===c.lon.toFixed(6)}))||(this.settings.c=[].concat(n()(this.cities),[c]),this.saveSettings()),this.clearCityEntry()}}},updateCity:function(t){this.settings.c.find((function(e){return Number(e.lat).toFixed(6)===Number(t.lat).toFixed(6)&&Number(e.lon).toFixed(6)===Number(t.lon).toFixed(6)})).n=t.n,this.updateForecastData(),this.$eventBus.$emit("toggle-sidebar",{name:"weather"})},deleteCity:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.settings.c=this.cities.filter((function(e){return!(Number(e.lat).toFixed(6)===Number(t.lat).toFixed(6)&&Number(e.lon).toFixed(6)===Number(t.lon).toFixed(6))})),this.removeForecastItem(t),this.saveSettings(),e&&this.$eventBus.$emit("toggle-sidebar",{name:"weather"})},toggleEditCitySidebar:function(t){var e=this.widgetData,i=e.column,s=e.id;this.$eventBus.$emit("toggle-sidebar",{name:"weather"},{column:i,id:s,city:t,type:"edit",title:"Edit",onSaveHandler:this.updateCity,onDeleteHandler:this.deleteCity})},updateForecastData:function(){var t=this;this.saveSettings().then((function(){return t.fetchForecastData(!0)}))},isEmpty:function(){return 0===this.cities.length&&!this.isLiveCopy},emptyWidgetActionConfig:function(){var t=this;return{icon:"map-pin",label:this.$t("widgets.worldclock.add_city"),actionHandler:function(){return t.toggleEditing(t.widgetData.id)}}},getCityName:function(t){var e=null;try{e=this.cities.find((function(e){return Number(e.lat).toFixed(6)===Number(t.lat).toFixed(6)&&Number(e.lon).toFixed(6)===Number(t.lon).toFixed(6)}))}catch(i){}return!e&&t.zmw&&(e=this.cities.find((function(e){return e.z===t.zmw}))),e?e.n:"?"},getLinkToWeatherLocation:function(t){return t&&t.lat&&t.lon?"https://weather.com/weather/today/l/".concat(t.lat,",").concat(t.lon):"#"},getIconUrl:function(t){var e="";return!t.icon&&t.icon_url?t.icon_url:(t.icon&&(e=f[t.icon]),e||(e="cloudy"),"https://static.start.me/weather/".concat(e,".gif"))},getCitySuggestions:function(t){var e=this;return t.trim().length<3?Promise.resolve([]):this.fetchCitySuggestions(t.trim()).then((function(t){return t.map((function(t){var i=e.$te("area.".concat(t.country.toLowerCase()),"en")?e.$t("area.".concat(t.country.toLowerCase())):t.country,s=t.state,n=i;return s&&(n+=", ".concat(s)),{name:"".concat(t.city," (").concat(n,")"),value:"".concat(t.latitude,",").concat(t.longitude),icon:"map-pin"}}))}))},fetchForecastData:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.fetchWeatherForecast({cities:this.cities,isForced:this.widgetData.isPreviewMode||e}).then((function(){t.migrateZmwToLatLon()}))},migrateZmwToLatLon:function(){var t=this,e=!1;this.settings.c=this.cities.map((function(i){if(i.lat&&i.lon)return i;if(i.z){var s=t.forecastData.filter((function(t){return t.zmw===i.z}));s&&s[0]&&s[0].lat&&s[0].lon&&(i.lat=s[0].lat,i.lon=s[0].lon,e=!0)}return i})),e&&this.saveSettings()},settingsDefaults:function(){return{c:[],m:0}}})},m=w,v=(i(1591),i(8)),C=Object(v.a)(m,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"weather-widget"},[e("BaseWidget",{ref:"widget",class:{"weather-widget_theme_dark":t.isDark},attrs:{"is-marginless":""}},[e("div",{staticClass:"weather-widget__body"},[t.isEditingState?[e("draggable",t._b({staticClass:"weather-widget__list",attrs:{tag:"ul"},on:{end:t.updateForecastData},model:{value:t.settings.c,callback:function(e){t.$set(t.settings,"c",e)},expression:"settings.c"}},"draggable",{group:"cities",disabled:!t.isEditingState,ghostClass:"weather-widget__city_ghost",dragClass:"weather-widget__city_is-dragged"},!1),t._l(t.cities,(function(i){return e("li",{key:`edit_${i.lat}_${i.lon}`,staticClass:"weather-widget__city",on:{click:function(e){return t.toggleEditCitySidebar(i)}}},[e("div",{staticClass:"weather-widget__city-container"},[e("SvgStrokeIcon",{staticClass:"weather-widget__icon weather-widget__icon_hiding",attrs:{icon:"map-pin",options:{size:14}}}),t._v(" "),e("SvgStrokeIcon",{staticClass:"weather-widget__icon weather-widget__icon_changing",attrs:{icon:"edit-3",options:{size:14}}}),t._v(" "),e("span",{staticClass:"weather-widget__text"},[t._v(t._s(i.n))]),t._v(" "),e("span",{staticClass:"weather-widget__icon-container",on:{click:function(e){return e.stopPropagation(),t.deleteCity(i)}}},[e("SvgStrokeIcon",{staticClass:"weather-widget__icon weather-widget__icon_grey",attrs:{icon:"trash-2",options:{size:14}}})],1)],1)])})),0),t._v(" "),t.isEditingState?e("AutocompleteList",{staticClass:"weather-widget__inline-add-form",attrs:{value:t.newCityInput,"suggestions-fetcher":t.getCitySuggestions,"option-chosen-handler":t.addCity,"is-blurred":t.isFormBlurred,"is-selected":t.isInputSelected,"activate-label":t.$t("new_city"),"input-placeholder":t.$t("widgets.worldclock.city_name")},model:{value:t.newCityInput,callback:function(e){t.newCityInput=e},expression:"newCityInput"}}):t._e()]:[t.isRefreshing?t._e():e("ul",{staticClass:"weather-widget__forecast-list"},t._l(t.forecastData,(function(i){return e("li",{key:`fc_${i.lat}_${i.lon}`,staticClass:"weather-widget__forecast-item"},[e("a",{staticClass:"weather-widget__link",attrs:{target:"_blank",href:t.getLinkToWeatherLocation(i)}},[e("div",{staticClass:"weather-widget__title"},[t._v(t._s(t.getCityName(i)))])]),t._v(" "),e("ul",{staticClass:"weather-widget__list-of-days"},[e("li",{staticClass:"weather-widget__day"},[e("span",{staticClass:"weather-widget__text weather-widget__text_small"},[t._v("\n                  "+t._s(t.$t("weather_widget.now"))+"\n                ")]),t._v(" "),e("div",{staticClass:"weather-widget__container"},[e("img",{staticClass:"weather-widget__icon",attrs:{src:t.$urlHelper.stripProtocol(t.getIconUrl(i.current),!0),alt:i.current.conditions,title:i.current.conditions}})]),t._v(" "),e("div",{staticClass:"weather-widget__container"},[t.isFahrenheit?e("span",{staticClass:"weather-widget__text weather-widget__text_small weather-widget__text_bold"},[t._v(t._s(i.current.current.temp_f)+"\xb0F")]):e("span",{staticClass:"weather-widget__text weather-widget__text_small weather-widget__text_bold"},[t._v(t._s(i.current.current.temp_c)+"\xb0C")])])]),t._v(" "),t._l(i.forecasts,(function(i){return e("li",{key:i.epoch,staticClass:"weather-widget__day"},[e("span",{staticClass:"weather-widget__text weather-widget__text_small"},[t._v("\n                  "+t._s(t.$utils.getUnixDayjs(i.epoch).format("dddd"))+"\n                ")]),t._v(" "),e("div",{staticClass:"weather-widget__container"},[e("img",{staticClass:"weather-widget__icon",attrs:{src:t.$urlHelper.stripProtocol(t.getIconUrl(i),!0),alt:i.conditions,title:i.conditions}})]),t._v(" "),e("div",{staticClass:"weather-widget__container"},[t.isFahrenheit?[e("span",{staticClass:"weather-widget__text weather-widget__text_small weather-widget__text_bold"},[t._v("\n                      "+t._s(i.high.temp_f)+"\xb0F\n                    ")]),t._v(" |\n\n                    "),e("span",{staticClass:"weather-widget__text weather-widget__text_small"},[t._v("\n                      "+t._s(i.low.temp_f)+"\xb0F\n                    ")])]:[e("span",{staticClass:"weather-widget__text weather-widget__text_small weather-widget__text_bold"},[t._v("\n                      "+t._s(i.high.temp_c)+"\xb0C\n                    ")]),t._v(" |\n\n                    "),e("span",{staticClass:"weather-widget__text weather-widget__text_small"},[t._v("\n                      "+t._s(i.low.temp_c)+"\xb0C\n                    ")])]],2)])}))],2)])})),0)]],2)])],1)}),[],!1,null,null,null);e.default=C.exports},788:function(t,e,i){},832:function(t,e,i){"use strict";i(788)},868:function(t,e,i){"use strict";var s=i(3),n=i(127),a=i.n(n),o=i(27),c=void 0,r={name:"AutocompleteList",components:{SvgStrokeIcon:o.default},props:{value:s.a.string,suggestionsFetcher:s.a.func.isRequired,optionChosenHandler:s.a.func.isRequired,isBlurred:s.a.bool.def(!1),isSelected:s.a.bool.def(!1),activateLabel:s.a.string.isRequired,inputPlaceholder:s.a.string.isRequired},data:function(){return{selectedIndex:0,suggestions:[],inputValue:this.value,isInputSelected:this.isSelected,isFormBlurred:this.isBlurred}},watch:{isSelected:function(t){t&&(this.isInputSelected=t)},isInputSelected:function(t){t&&this.selectAndFocusInput()},isBlurred:function(t){c.isFormBlurred=t},value:function(t){this.inputValue=t},inputValue:a()((function(t){var e=this;t?this.suggestionsFetcher(t).then((function(t){e.suggestions=t})).catch((function(t){e.$logger.log(t),e.clearSuggestions()})):this.clearSuggestions()}),500)},created:function(){this.$eventBus.$on("keypress-escape",this.clearSuggestions)},beforeDestroy:function(){this.$eventBus.$off("keypress-escape",this.clearSuggestions)},mounted:function(){this.isInputSelected&&this.selectAndFocusInput()},methods:{activateInput:function(){this.isInputSelected=!0,this.isFormBlurred=!1},deactivateInput:function(){this.isInputSelected=!1,this.isFormBlurred=!0,this.clearSuggestions()},clearSuggestions:function(){this.suggestions=[],this.selectedIndex=0},clearInput:function(){this.inputValue=""},selectAndFocusInput:function(){this.$refs.input.focus(),this.$refs.input.select()},changeSelected:function(t){this.setSelectedIndex(this.selectedIndex+(parseInt(t)||0));var e=this.$el.querySelector(".autocomplete-list__select > li:nth-child(".concat(this.selectedIndex+1,")"));e&&e.scrollIntoView(!1)},handleOptionChosen:function(){this.suggestions[this.selectedIndex]&&(this.optionChosenHandler(this.suggestions[this.selectedIndex]),this.clearSuggestions(),this.clearInput())},setSelectedIndex:function(t){t<0?this.selectedIndex=this.suggestions.length-1:t>=this.suggestions.length?this.selectedIndex=0:this.selectedIndex=t}}},l=(i(832),i(8)),u=Object(l.a)(r,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"autocomplete-list"},[e("div",{staticClass:"autocomplete-list__form",class:{"autocomplete-list__form_blurred":t.isFormBlurred}},[e("div",{staticClass:"autocomplete-list__wrapper"},[e("div",{staticClass:"autocomplete-list__inputbox"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.inputValue,expression:"inputValue"}],ref:"input",staticClass:"autocomplete-list__input",attrs:{type:"text",placeholder:t.inputPlaceholder},domProps:{value:t.inputValue},on:{keydown:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.stopPropagation(),t.handleOptionChosen.apply(null,arguments))},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"down",40,e.key,["Down","ArrowDown"])?null:t.changeSelected(1)},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"up",38,e.key,["Up","ArrowUp"])?null:t.changeSelected(-1)}],focus:t.activateInput,blur:t.deactivateInput,click:function(t){t.stopPropagation()},paste:function(t){t.stopPropagation()},input:function(e){e.target.composing||(t.inputValue=e.target.value)}}})]),t._v(" "),e("div",{staticClass:"autocomplete-list__buttons"},[e("div",{staticClass:"autocomplete-list__buttons-wrapper"},[t.inputValue.length?e("a",{staticClass:"autocomplete-list__button",attrs:{title:t.$t("clear")},on:{click:function(e){return e.stopPropagation(),t.clearInput.apply(null,arguments)}}},[e("SvgStrokeIcon",{staticClass:"autocomplete-list__feather-icon",attrs:{icon:"x",options:{size:16}}})],1):t._e(),t._v(" "),e("a",{staticClass:"autocomplete-list__button",attrs:{title:t.$t("add")},on:{click:function(e){return e.stopPropagation(),t.handleOptionChosen.apply(null,arguments)}}},[e("SvgStrokeIcon",{staticClass:"autocomplete-list__feather-icon",attrs:{icon:"plus",options:{size:16}}})],1)])])])]),t._v(" "),t.suggestions.length>0&&!t.isFormBlurred?e("div",{staticClass:"autocomplete-list__hidden"},[e("ul",{staticClass:"autocomplete-list__select"},t._l(t.suggestions,(function(i,s){return e("li",{key:s,staticClass:"autocomplete-list__selectable",class:{"autocomplete-list__selectable_selected":s===t.selectedIndex},on:{mousedown:t.handleOptionChosen,mouseenter:function(e){return t.setSelectedIndex(s)}}},[i.icon?e("SvgStrokeIcon",{staticClass:"autocomplete-list__icon",attrs:{icon:i.icon,options:{size:20}}}):t._e(),t._v(" "),e("span",{staticClass:"autocomplete-list__title"},[t._v(t._s(i.name))])],1)})),0)]):t._e()])}),[],!1,null,null,null);e.a=u.exports}}]);