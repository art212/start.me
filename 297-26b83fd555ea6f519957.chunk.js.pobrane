(window.webpackJsonp=window.webpackJsonp||[]).push([[297],{1098:function(e,t,a){},1567:function(e,t,a){"use strict";a(1098)},2213:function(e,t,a){"use strict";a.r(t);var i=a(4),s=a.n(i),n=a(3),r=a(182),o=a.n(r),l=a(127),g=a.n(l),c=a(15),u=a(27),d=a(5),p={name:"PagesBar",components:{DropList:function(){return a.e(13).then(a.bind(null,1986))},draggable:o.a,SvgStrokeIcon:u.default},props:{page:n.a.object,pageList:n.a.array.def([]),activePageId:n.a.string,hasBackground:n.a.bool.def(!1),isSorting:n.a.bool.def(!1),isPinned:n.a.bool.def(!1),isTeamDomain:n.a.bool.def(!1),hasLightText:n.a.bool.def(!1)},data:function(){return{isExpanded:!1,isDragged:!1,overflownItems:[],pages:[]}},computed:s()({},Object(c.c)(["getUserData","isLoggedIn"]),{isSafari:function(){return this.$featurizr&&this.$featurizr.browser&&["safari","other"].includes(this.$featurizr.browser)},isFirefox:function(){return this.$featurizr&&"firefox"===this.$featurizr.browser},dndOptions:function(){var e={group:{name:"pages-bar-list",pull:function(e,t){return e&&e.options&&e.options.group&&"pages-bar-list"===e.options.group.name}},ghostClass:"pages-bar__item_ghost",dragClass:"pages-bar__item_is-dragged",touchStartThreshold:3,disabled:this.isDraggableDisabled,animation:200,forceFallback:!0,fallbackTolerance:5};return this.isFirefox&&(e.forceFallback=!1),e},margin:function(){return d.a.horizontalPagesMenuItemsMargin},hasOverflow:function(){return this.overflownItems.length>0},isTeamOwner:function(){return this.page&&this.page.organization&&(this.page.organization.owner||this.page.organization.enterprise&&(this.page.organization.enterprise.owner||this.page.organization.enterprise.owner_id===this.getUserData.id))},isTeamAdmin:function(){return this.page&&this.page.organization&&(this.page.organization.admin||this.page.organization.enterprise&&this.page.organization.enterprise.admin)},isDraggableDisabled:function(){if(this.page&&(this.page.is_archived||this.page.organization_id&&!this.isTeamOwner&&!this.isTeamAdmin))return!0;var e=!1;e=e||!this.isLoggedIn;try{e=void 0!==this.pages[0].organization&&this.pages[0].organization.lock_teammenu&&!this.pages[0].organization.admin&&!this.pages[0].organization.owner}catch(t){}return e}}),watch:{pages:function(){var e=this;this.$utils.postpone(this.calculateOverflownItems),this.isSafari&&this.$nextTick((function(){return e.toggleStyles()}))},$route:{handler:function(){this.pages=this.getPages()},immediate:!0},pageList:function(){this.pages=this.getPages()}},mounted:function(){window.addEventListener("resize",this.scheduleOverflowCalculation),this.$eventBus.$on("refreshNavigationData",this.scheduleOverflowCalculation)},beforeDestroy:function(){window.removeEventListener("resize",this.scheduleOverflowCalculation),this.$eventBus.$off("refreshNavigationData",this.scheduleOverflowCalculation)},methods:{getPages:function(){var e=this;return this.pageList.map((function(t){var a=e.$utils.slugify(t.title);return s()({},t,{title:t.title.slice(0,50),path:"/p/".concat(t.public_id).concat(a?"/"+a:"")})}))},toggleStyles:function(){var e=this.$el.querySelector(".pages-bar__list");e&&(e.style.flexBasis="100%",window.requestAnimationFrame((function(){e.style.flexBasis="auto"})))},scheduleOverflowCalculation:g()((function(){this.calculateOverflownItems()}),100),calculateOverflownItems:function(){var e=this;this.overflownItems=[];var t=this.$refs.page;if(t){var a=!1,i=0;t.forEach((function(e){e.classList.remove("pages-bar__item_draggable"),e.classList.remove("pages-bar__item_overflown")})),t.forEach((function(t,s){var n=t.getBoundingClientRect().top;if(0===s)return i=n,void t.classList.add("pages-bar__item_draggable");n!==i?(a||(a=!0,e.fillOverflowMenu()),t.classList.add("pages-bar__item_overflown")):t.classList.add("pages-bar__item_draggable")}))}},fillOverflowMenu:function(){var e=this;this.overflownItems=this.pages.map((function(t){return{id:t.public_id,name:t.title,isLink:!0,path:t.path,isBlue:e.activePageId===t.public_id,clickHandler:function(){e.isExpanded=!1}}}))},isActiveLink:function(e){return!!e.public_id&&this.activePageId===e.public_id},getPageRoute:function(e){var t=this.$route.name,a={name:t};if(["WidgetPage","catch-all"].includes(t))a.name="WidgetPage",a.params={publicId:e.public_id,slug:e.public_url?e.public_url:this.$utils.slugify(e.title)};else if("StaticPage"===t)try{a={path:new URL(e.url).pathname}}catch(i){}else"DiscoverPage"===t&&(a.params={area:this.$route.params.area,subject:e.public_id});return a},toggleMenu:function(){this.isExpanded=!this.isExpanded},collapseMenu:function(e){var t=this;e.target&&e.target.classList&&e.target.classList.contains("pages-bar__more")||this.$nextTick((function(){t.isExpanded&&(t.isExpanded=!1)}))},emitPagesReordered:function(){this.$eventBus.$emit("reordered",this.pages)},startDragging:function(){this.isDragged=!0,this.isFirefox||document.documentElement.classList.add("draggable-cursor")},endDragging:function(){this.isDragged=!1,this.isFirefox||document.documentElement.classList.remove("draggable-cursor")},emitPageContextMenu:function(e,t){this.isActiveLink(e)&&this.$eventBus.$emit("toggle-page-context-menu",{id:e.id,event:t})}}},h=(a(1567),a(8)),f=Object(h.a)(p,(function(){var e=this,t=e._self._c;return t("nav",{ref:"list",staticClass:"pages-bar clearfix",class:{"pages-bar_mobile":e.$utils.isMobileDevice(),"pages-bar_dragged":e.isDragged}},[t("div",{staticClass:"pages-bar__wrapper"},[t("draggable",e._b({class:["pages-bar__list",{"pages-bar__list_light":e.hasLightText,"pages-bar__list_darkened":e.hasBackground,shortened:e.hasOverflow,expanded:e.isExpanded}],attrs:{tag:"div",draggable:".pages-bar__item_draggable"},on:{start:e.startDragging,update:e.emitPagesReordered,end:e.endDragging},model:{value:e.pages,callback:function(t){e.pages=t},expression:"pages"}},"draggable",e.dndOptions,!1),[t("transition-group",{staticClass:"pages-bar__list-container",attrs:{tag:"ul",type:"transition",name:e.isDragged?"flip-list":null}},e._l(e.pages,(function(a,i){return t("li",{key:`page_${a.public_id}`,ref:"page",refInFor:!0,staticClass:"pages-bar__item pages-bar__item_draggable",class:{"pages-bar__item_active":e.isActiveLink(a),"pages-bar__item_left":0===i,"pages-bar__item_shaded":!e.isActiveLink(a)&&e.hasBackground},on:{contextmenu:function(t){return e.emitPageContextMenu(a,t)}}},[e.isActiveLink(a)?t("h1",{staticClass:"pages-bar__link pages-bar__link_active"},[e._v(e._s(a.title))]):t("router-link",{staticClass:"pages-bar__link",attrs:{to:e.getPageRoute(a)}},[e._v(e._s(a.title))])],1)})),0)],1),e._v(" "),e.overflownItems.length>0?t("div",{ref:"more",staticClass:"pages-bar__item pages-bar__item_more",class:{"pages-bar__item_shaded":e.hasBackground}},[t("a",{staticClass:"pages-bar__more",on:{click:function(t){return t.stopPropagation(),e.toggleMenu.apply(null,arguments)}}},[t("SvgStrokeIcon",{staticClass:"pages-bar__dots",attrs:{icon:"chevron-down",options:{size:16}}})],1)]):e._e()],1),e._v(" "),(e.$utils.isMobileDevice()?e.isExpanded&&e.overflownItems.length>0:e.overflownItems.length>0)?t("div",{staticClass:"pages-bar__hidden",class:{"pages-bar__hidden_expanded":e.isExpanded}},[t("DropList",{directives:[{name:"click-outside",rawName:"v-click-outside",value:e.collapseMenu,expression:"collapseMenu"}],staticClass:"pages-bar__droplist",attrs:{items:e.overflownItems,"is-relative":!e.$utils.isMobileDevice(),"is-fixed":e.$utils.isMobileDevice(),"is-bound-by-page":""}})],1):e._e()])}),[],!1,null,null,null);t.default=f.exports}}]);